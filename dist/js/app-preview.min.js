"use strict";window.$=window.jQuery=require("jquery");const fs=require("fs-extra"),{ipcRenderer:ipcRenderer}=require("electron"),electron=require("electron"),remote=electron.remote,dialog=remote.dialog,path=require("path"),loadJsonFile=require("load-json-file"),Store=require("electron-store"),store=new Store,fontSizes=[9,10,11,12,13,14,18,24,36,48,64,72,96,144];function injectCSS(t,e,n,s){let o;o=0==s?`${n}/${e}`:n;$("<div />",{html:`<style>\n\t\t\t\t@font-face {\n\t\t\t\t\tfont-family: "${t}";\n\t\t\t\t\tsrc:url("file://${o}");\n\t\t\t\t}\n\t\t\t</style>`}).appendTo("body")}function listItem(t,e,n,s,o){$("#font-list ul").append(`<li class="${t} ${e}" data-font="${n}" title="${s}">\n\t\t\t<div>${o}</div>\n\t\t</li>`)}function addPreview(t){let e=fontName(t,0),n=fontName(t,1),s=store.get("fontPreview.color"),o=store.get("fontPreview.size"),l=fontSizes[o];$("#preview-list").append(`<article class="preview-item" data-target="${n}">\n\t\t<h2>${e}</h2>\n\t\t<div class="preview-text" style="font-family: '${n}'; color: ${s}; font-size: ${l}px;">\n\t\t\t<p>ABCDEFGHIJKLM<br class="break">NOPQRSTUVWXYZ<br>\n\t\t\tabcdefghijklm<br class="break">nopqrstuvwxyz<br>\n\t\t\t1234567890</p>\n\t\t</div>\n\t</article>`),o>8&&$(".break").hide()}function fontName(t,e){let n,s=t.split(".");return n=0==e?s[0].replace(/(-|_)/g," "):s[0]}function injectGlyphs(t,e){$("#glyph-list").empty(),loadJsonFile(path.join(__dirname,`../json/${e}-chars.json`)).then(e=>{$("#glyph-list").append('<div id="maths"><h2>maths</h2>'),e.forEach(function(t){let e="";t.e&&(e=`<tr>\n\t\t\t\t<th>html entity</th>\n\t\t\t\t<td>&amp;${t.e}</td>\n\t\t\t</tr>\n\t\t\t`),$("#glyph-list").append(`<div class="glyph">\n\t<figure class="glyph-sample" title="${t.n}" data-glyph='${JSON.stringify(t)}'>\n\t\t&${t.x}\n\t</figure>\n\t\n\t<table>\n\t\t<tbody>\n\t\t\t<tr>\n\t\t\t\t<th>description</th>\n\t\t\t\t<td><span>${t.n}</span></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<th>unicode</th>\n\t\t\t\t<td>${t.u}</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<th>hex code</th>\n\t\t\t\t<td>&amp;${t.x}</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<th>html code</th>\n\t\t\t\t<td>&amp;${t.h}</td>\n\t\t\t</tr>\n\t\t\t${e}\n\t\t</tbody>\n\t</table>\n</div>\n`)}),$("#glyph-list").append("</div>"),styleGlyphs(t)})}function styleGlyphs(t){console.log("name: "+t);let e=fontName(t,1),n=store.get("fontPreview.color"),s=fontSizes[store.get("fontPreview.size")];console.log("family: "+e),$(".glyph-sample").css({"font-family":e}),$(".glyph-sample").css({"font-size":`${s}px`}),$(".glyph-sample").css({color:n})}function setPrefs(){let{size:t,color:e}=store.get("fontPreview");$("#font-size").val(t),$("#font-size-val").html(fontSizes[t]),$("#font-color").val(e),$("#font-color-swatch").css({"background-color":e})}ipcRenderer.on("selected-font",(t,e)=>{let n=e[0],s=e[1];fs.stat(s,(t,e)=>{if(t)t.code&&dialog.showErrorBox(`An error occured whilst previewing the font: ${n}`,t.code);else if(e.isDirectory()){let t=0;listItem("folder","selected","show-all",n,fontName(n,0)),fs.readdir(s,(e,n)=>{if(e)throw e;for(let e of n)e.startsWith(".")||(injectCSS(fontName(e,1),e,s,0),listItem("file","",fontName(e,1),e,fontName(e,0)),addPreview(e),0==t&&injectGlyphs(fontName(e,1),"letters"),t++)})}else injectCSS(fontName(n,1),n,s,1),listItem("file","selected",fontName(n,1),n,fontName(n,0)),addPreview(n),injectGlyphs(n,"letters")})}),$("body").on("click","#font-list ul li",function(t){let e,n=$(this).data("font");"show-all"!==n&&styleGlyphs(n),e="show-all"==n?$("#preview-list article"):$(`#preview-list article[data-target="${n}"]`),$("#font-list ul li").removeClass("selected"),$(this).toggleClass("selected"),$("#preview-list article").fadeOut().promise().done(function(){e.fadeIn("fast")})}),$("body").on("mouseup",".glyph-sample",function(){let t=$(this).data("glyph");ipcRenderer.send("show-glyph-menu",t)}),$("#show-fonts").click(function(){$("#show-glyphs").removeClass("selected"),$("#glyph-list, #glyph-types").fadeOut().promise().done(function(){$("#show-fonts").addClass("selected"),$("#preview-list").fadeIn("fast")})}),$("#show-glyphs").click(function(){$("#show-fonts").removeClass("selected"),$("#preview-list").fadeOut().promise().done(function(){$("#show-glyphs").addClass("selected"),$("#glyph-list, #glyph-types").fadeIn("fast")})}),$("#font-size").change(function(){let t=parseInt($(this).val()),e=fontSizes[t];t>8?$(".break").hide():$(".break").show(),$(".preview-text, .glyph-sample").css({"font-size":`${e}px`}),$("#font-size-val").html(e),store.set("fontPreview.size",t)}),$("#font-color").change(function(){let t=$(this).val();$(".preview-text, .glyph-sample").css({color:t}),$("#font-color-swatch").css({"background-color":t}),store.set("fontPreview.color",t)}),$("#glyph-types").change(function(){let t=$("#font-list li.selected").data("font"),e=$("#glyph-types").val();"show-all"==t&&(t=$("#font-list li.selected").next().data("font")),injectGlyphs(t,e)}),$(document).ready(function(){setPrefs()});
//# sourceMappingURL=maps/app-preview.min.js.map
