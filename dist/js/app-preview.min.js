"use strict";window.$=window.jQuery=require("jquery");const fs=require("fs-extra"),{ipcRenderer:ipcRenderer}=require("electron"),electron=require("electron"),remote=electron.remote,dialog=remote.dialog,path=require("path"),loadJsonFile=require("load-json-file"),Store=require("electron-store"),store=new Store;function listItem(t,e,o,i,l){$("#font-list ul").append(`<li class="${t} ${e}" data-font="${o}" title="${i}">\n\t\t\t<div>${l}</div>\n\t\t</li>`)}function injectCSS(t,e,o,i){let l;l=0==i?`${o}/${e}`:o;$("<div />",{html:`<style>\n\t\t\t\t@font-face {\n\t\t\t\t\tfont-family: "${t}";\n\t\t\t\t\tsrc:url("file://${l}");\n\t\t\t\t}\n\t\t\t</style>`}).appendTo("body")}function addPreview(t){let e=fontName(t,0),o=fontName(t,1),i=store.get("fontPreview.color"),l=store.get("fontPreview.size");$("#preview-list").append(`<article class="preview-item" data-target="${o}">\n\t\t<h2>${e}</h2>\n\t\t<div class="preview-text" style="font-family: '${o}'; color: ${i}; font-size: ${l}px;">\n\t\t\t<p>ABCDEFGHIJKLM<br>NOPQRSTUVWXYZ<br>\n\t\t\tabcdefghijklm<br>nopqrstuvwxyz<br>\n\t\t\t1234567890</p>\n\t\t</div>\n\t</article>`)}function fontName(t,e){let o,i=t.split(".");return o=0==e?i[0].replace(/(-|_)/g," "):i[0]}function injectGlyphs(){loadJsonFile(path.join(__dirname,"../json/unicode-chars.json")).then(t=>{for(let e=0,o=t.length;e<o;e++)$("#glyph-list").append(`<div class="glyph-item" title="${t[e].n}">&${t[e].h}</div>`)})}function styleGlyphs(t){let{size:e,color:o}=store.get("fontPreview");$("#glyph-list").css({"font-family":t,color:o,"font-size":e+"px"})}function setPrefs(){let{size:t,color:e}=store.get("fontPreview");$("#font-size").val(t),$("#font-size-val").html(t),$("#font-color").val(e),$("#font-color-swatch").css({"background-color":e})}ipcRenderer.on("selected-font",(t,e)=>{let o=e[0],i=e[1];injectGlyphs(),fs.stat(i,(t,e)=>{if(t)t.code&&dialog.showErrorBox(`An error occured whilst previewing the font: ${o}`,t.code);else if(e.isDirectory()){let t=0;listItem("folder","selected","show-all",o,fontName(o,0)),fs.readdir(i,(e,o)=>{if(e)throw e;for(let e of o)e.startsWith(".")||(injectCSS(fontName(e,1),e,i,0),listItem("file","",fontName(e,1),e,fontName(e,0)),addPreview(e),0==t&&styleGlyphs(fontName(e,1)),t++)})}else injectCSS(fontName(o,1),o,i,1),listItem("file","selected",fontName(o,1),o,fontName(o,0)),addPreview(o),styleGlyphs(fontName(o,1))})}),$("body").on("click","#font-list ul li",function(t){let e,o=$(this).data("font");"show-all"!==o&&styleGlyphs(o),e="show-all"==o?$("#preview-list article"):$(`#preview-list article[data-target="${o}"]`),$("#font-list ul li").removeClass("selected"),$(this).toggleClass("selected"),$("#preview-list article").fadeOut().promise().done(function(){e.fadeIn("fast")})}),$("#show-fonts").click(function(){$("#glyph-list").fadeOut().promise().done(function(){$("#preview-list").fadeIn("fast")})}),$("#show-glyphs").click(function(){$("#preview-list").fadeOut().promise().done(function(){$("#glyph-list").fadeIn("fast")})}),$("#font-size").change(function(){let t=$(this).val();$(".preview-text, #glyph-list").css({"font-size":`${t}px`}),$("#font-size-val").html(t),store.set("fontPreview.size",t)}),$("#font-color").change(function(){let t=$(this).val();$(".preview-text, #glyph-list").css({color:t}),$("#font-color-swatch").css({"background-color":t}),store.set("fontPreview.color",t)}),$(document).ready(function(){setPrefs()});
//# sourceMappingURL=maps/app-preview.min.js.map
