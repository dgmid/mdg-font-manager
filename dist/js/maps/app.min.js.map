{"version":3,"sources":["app.js"],"names":["window","$","jQuery","require","fs","ipcRenderer","electron","remote","dialog","Store","store","path","modal","populateFontLists","activePath","disabledPath","get","html","addItemsToList","fadeIn","updateLists","hide","remove","prop","oldPath","newPath","list","prefs","readdir","err","files","total","sort","a","b","toLowerCase","localeCompare","reverse","divider","file","item","statSync","isDirectory","startsWith","display","parse","name","dividers","charAt","toUpperCase","append","move","count","callback","rename","code","showErrorBox","deleteItems","updateButtonState","val","show","active","length","disabled","deleteSelected","fadeOut","counter","items","each","index","value","this","data","exportSelected","selected","message","$this","push","send","updateAll","setDragArea","id","dragArea","document","getElementById","draggedItems","location","ondragover","addClass","ondragleave","removeClass","ondragend","ondrop","event","preventDefault","dataTransfer","openModal","url","width","height","resize","BrowserWindow","parent","getCurrentWindow","minWidth","maxWidth","minHeight","resizable","backgroundColor","loadURL","once","on","which","toggleClass","click","console","log","__dirname","mouseup","e","focus","showMessageBox","detail","buttons","Notification","body","listItems","children","empty","forEach","set","dir","bind","searchString","text","indexOf","hasClass"],"mappings":"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","file":"../app.min.js","sourcesContent":["'use strict'\n\nwindow.$ = window.jQuery = require( 'jquery' )\nconst fs = require( 'fs-extra' )\nconst {ipcRenderer} = require( 'electron' )\nconst electron = require(\"electron\")\nconst remote = electron.remote\nconst dialog = remote.dialog\nconst Store = require( 'electron-store' )\nconst store = new Store()\n\nconst path = require('path')\n\nlet modal\n\npopulateFontLists()\n\n\n\n//note(@duncanmid): populate font lists\n\nfunction populateFontLists() {\n\t\n\tlet {activePath, disabledPath} = store.get('fontDirectories')\n\t\n\t$('#active-menu').html(activePath)\n\t$('#disabled-menu').html(disabledPath)\n\t\n\taddItemsToList(\tactivePath, disabledPath, 'active' )\n\taddItemsToList( disabledPath, activePath, 'disabled' )\n\t\n\t$('#left-panel ul, #right-panel ul').fadeIn('fast')\n}\n\n\n\n//note(@duncanmid): update lists\n\nfunction updateLists() {\n\t\n\t$('#active-count, #disabled-count').html('').hide()\n\t$('#active-list li, #disabled-list li').remove()\n\t$('#update-all').prop('disabled', true)\n\t\n\tpopulateFontLists()\n\t\n}\n\n\n\n//note(@duncanmid): add items to lists\n\nfunction addItemsToList( oldPath, newPath, list) {\n\t\n\tlet prefs = store.get('appPrefs')\n\t\n\tfs.readdir( oldPath, ( err, files ) => {\n\t\t\n\t\tif( err ) {\n\t\t\t\n\t\t\tthrow err\n\t\t\n\t\t} else {\n\t\t\t\n\t\t\tlet total = 0\n\t\t\t\n\t\t\tfiles.sort(function ( a, b ) {\n\t\t\t\t\n\t\t\t\treturn a.toLowerCase().localeCompare( b.toLowerCase() )\n\t\t\t})\n\t\t\t\n\t\t\tif( store.get( `fontOrder.${list}` ) == 1 ) files.reverse()\n\t\t\t\n\t\t\tlet divider = '';\n\t\t\t\n\t\t\tfor ( let file of files ) {\n\t\t\t\t\n\t\t\t\tlet item\n\t\t\t\tlet stats = fs.statSync( oldPath + file )\n\t\t\t\t\n\t\t\t\tif( stats.isDirectory() ) {\n\t\t\t\t\t\n\t\t\t\t\titem = 'folder'\n\t\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\t\t\n\t\t\t\t\titem = 'file'\n\t\t\t\t}\n\t\t\t\n\t\t\t\tif( !file.startsWith('.') ) {\n\t\t\t\t\t\n\t\t\t\t\tlet display = ( prefs.extensions ) ? file : path.parse(file).name\n\t\t\t\t\t\n\t\t\t\t\tif( prefs.dividers ) {\n\t\t\t\t\t\n\t\t\t\t\t\tif( divider !== file.charAt(0) ) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tdivider = file.charAt(0).toUpperCase()\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t$(`#${list}-list`).append(`<li class=\"divider\"><span>${divider}</span></li>`)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t$(`#${list}-list`).append(`<li class=\"item ${item}\" data-name=\"${file}\" data-oldpath=\"${oldPath}${file}\" data-newpath=\"${newPath}${file}\" data-type=\"${item}\" title=\"${display}\"><div>${display}</div></li>`)\n\t\t\t\t\t\n\t\t\t\t\ttotal++\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t$(`#${list}-total`).html( total )\n\t\t}\n\t})\n}\n\n\n\n//note(@duncanmid): move selected files or folders\n\nfunction move( oldPath, newPath, count, total, callback ) {\t\n\t\n\tfs.rename(oldPath, newPath, function (err) {\n\t\t\n\t\tif (err) {\n\t\t\t\n\t\t\tswitch( err.code ) {\n\t\t\t\t\n\t\t\t\tcase 'ENOTEMPTY':\n\t\t\t\t\t\n\t\t\t\t\tdialog.showErrorBox(\n\t\t\t\t\t\t'An error occured whilst moving the fonts',\n\t\t\t\t\t\t'Some items could not be moved - you may have duplicate items in your Active and Disabled folders.'\n\t\t\t\t\t)\n\t\t\t\t\t\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase 'ENOENT':\n\t\t\t\t\t\n\t\t\t\t\tdialog.showErrorBox(\n\t\t\t\t\t\t'An error occured whilst moving the fonts',\n\t\t\t\t\t\t'Make sure the paths for the Active and Disabled directories are correctly set. If you don\\'t have a \"Fonts Disabled\" folder in your home Library, you may need to create one.'\n\t\t\t\t\t)\n\t\t\t\t\t\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tdefault:\n\t\t\t\t\n\t\t\t\tdialog.showErrorBox(\n\t\t\t\t\t'An error occured whilst moving the fonts', err.code\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\t\t\n\t\tif( (count + 1) === total ) {\n\t\t\t\n\t\t\tcallback()\n\t\t}\n\t})\n}\n\n\n\n//note(@duncanmid): delete items\n\nfunction deleteItems( oldPath, count, total, callback ) {\n\t\n\tfs.remove(oldPath, function (err) {\n\t\t\n\t\tif (err) {\n\t\t\t\n\t\t\tif (err.code) {\n\t\t\t\t\n\t\t\t\tdialog.showErrorBox(\n\t\t\t\t\t'An error occured whilst deleting the fonts', err.code\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\t\t\n\t\tif( (count + 1) === total ) {\n\t\t\t\n\t\t\tcallback()\n\t\t}\n\t})\n}\n\n\n\n//note(@duncanmid): update fonts button state\n\nfunction updateButtonState() {\n\t\n\t$('#search').val('')\n\t$('ul li').show()\n\t\n\tlet active\t\t= $('#active-list li.selected').length,\n\t\tdisabled \t= $('#disabled-list li.selected').length\n\t\n\tif( active + disabled > 0 ) {\n\t\t\n\t\t$('#update-all').prop('disabled', false)\n\t\n\t} else {\n\t\t\n\t\t$('#update-all').prop('disabled', true)\n\t}\n\t\n\tif( active > 0 ) {\n\t\t\n\t\t$('#active-count').html( active ).show()\n\t\n\t} else {\n\t\t\n\t\t$('#active-count').html('').hide()\n\t}\n\t\n\tif( disabled > 0 ) {\n\t\t\n\t\t$('#disabled-count').html( disabled ).show()\n\t\n\t} else {\n\t\t\n\t\t$('#disabled-count').html('').hide()\n\t}\n}\n\n\n\n//note(@duncanmid): on click list item\n\n$('body').on('mouseup', '#active-list li.item, #disabled-list li.item', function(event) {\n\t\n\tif( event.which === 3 ) {\n\n\t\t\n\t\tvar name = $(this).data('name'),\n\t\t\tpath = $(this).data('oldpath')\n\t\t\n\t\tipcRenderer.send('show-font-menu', [name, path] )\n\t\t\n\t} else {\n\t\t\n\t\t$(this).toggleClass('selected')\n\t\tupdateButtonState()\n\t}\n})\n\n\n\n//note(@duncanmid): delete selected\n\nfunction deleteSelected() {\n\t\n\t$('#left-panel ul, #right-panel ul').fadeOut('fast')\n\t\n\tvar counter = 0,\n\t\titems = $('#active-list li.selected, #disabled-list li.selected')\n\t\n\titems.each(function (index, value) {\n\t\t\n\t\tvar oldPath = $(this).data('oldpath')\n\t\t\n\t\tdeleteItems( oldPath, counter++, items.length, updateLists )\n\t})\n}\n\n\n\n//note(@duncanmid): export selected\n\nfunction exportSelected() {\n\t\n\tvar selected = $('#active-list li.selected, #disabled-list li.selected'),\n\t\tmessage = []\n\t\n\tselected.each( function() {\n\t\t\n\t\tvar $this = $(this)\n\t\tmessage.push( [ $this.data('name') ,$this.data('oldpath') ] )\n\t})\n\t\n\tipcRenderer.send('export-list', message)\n}\n\n\n\n//note(@duncanmid): update all\n\nfunction updateAll() {\n\t\n\t$('#left-panel ul, #right-panel ul').fadeOut('fast')\n\t\n\tvar counter = 0,\n\t\titems = $('#active-list li.selected, #disabled-list li.selected')\n\t\t\n\titems.each(function (index, value) {\n\t\t\n\t\tvar oldPath = $(this).data('oldpath'),\n\t\t\tnewPath = $(this).data('newpath')\n\t\t\n\t\tmove( oldPath, newPath, counter++, items.length, updateLists )\n\t})\n}\n\n\n\n$('#update-all').click( () => {\n\t\n\tupdateAll()\n})\n\n\n\n//note(@duncanmid): prefs modal\n\nipcRenderer.on('open-prefs', (event, message) => {\n\t\n\tconsole.log('REC - OPEN PREFS')\n\t\n\topenModal( 'file://' + __dirname + '/../html/prefs.html', 360, 280, false )\n})\n\n\n\n//note(@duncanmid): open font folder menus\n\n$('#active-menu').mouseup( (e) => {\n\t\n\te.preventDefault()\n\tipcRenderer.send('show-folder-menu', 'active')\n})\n\n$('#disabled-menu').mouseup( (e) => {\n\t\n\te.preventDefault()\n\tipcRenderer.send('show-folder-menu', 'disabled')\n})\n\n\n\n//note(@duncanmid): list-menu commands\n\nipcRenderer.on('select-all', (event, message) => {\n\t\n\t$('#' + message + '-list li.item').addClass('selected')\n\tupdateButtonState()\n})\n\nipcRenderer.on('deselect-all', (event, message) => {\n\t\n\t$('#' + message + '-list li').removeClass('selected')\n\tupdateButtonState()\n})\n\nipcRenderer.on('toggle-selection', (event, message) => {\n\t\n\t$('#' + message + '-list li.item').toggleClass('selected')\n\tupdateButtonState()\n})\n\nipcRenderer.on('find', () => {\n\t\n\t$('#search').focus()\n})\n\nipcRenderer.on('update-lists', () => {\n\t\n\tif( $('#update-all').prop('disabled') ) {\n\t\n\t\tdialog.showErrorBox(\n\t\t\t'No fonts are selected',\n\t\t\t'Select the fonts you would like to activate or disable.'\n\t\t)\n\t\n\t} else {\n\t\n\t\tupdateAll()\n\t}\n})\n\nipcRenderer.on('delete-fonts', () => {\n\n\tvar selected = $('#active-list li.selected, #disabled-list li.selected')\n\t\n\tif( selected.length > 0 ) {\n\t\t\n\t\tvar response = dialog.showMessageBox({\t\n\t\t\t\t\t\tmessage: 'Are you sure you want to delete the selected fonts?',\n\t\t\t\t\t\tdetail: 'This operation is not reversable.',\n\t\t\t\t\t\tbuttons: ['OK','Cancel']\n\t\t\t\t\t})\n\t\t\n\t\tif( response === 0 ) {\n\t\t\n\t\t\tdeleteSelected()\n\t\t}\n\t\n\t} else {\n\t\t\n\t\tdialog.showErrorBox(\n\t\t\t'No fonts are selected',\n\t\t\t'Select fonts from the Active and Disabled lists to delete them from your system.'\n\t\t)\n\t}\n})\n\nipcRenderer.on('delete-single', (event, message) => {\n\t\n\tdeleteItems( message, 0, 1, updateLists );\n})\n\nipcRenderer.on('export-fonts', () => {\n\t\n\tvar selected = $('#active-list li.selected, #disabled-list li.selected')\n\t\n\tif( selected.length > 0 ) {\n\t\t\n\t\texportSelected()\n\t\n\t} else {\n\t\t\n\t\tdialog.showErrorBox(\n\t\t\t'No fonts are selected',\n\t\t\t'Select fonts from the Active and Disabled lists to export them to the Desktop.'\n\t\t)\n\t}\n})\n\nipcRenderer.on('export-ok', (event, message) => {\n\t\n\tlet fontExportOk = new Notification('MDG Font Manager', {\n\t\tbody: `The selected fonts have been exported to: ${message}`\n\t})\n})\n\n\nipcRenderer.on('export-failed', () => {\n\t\n\tlet fontExportError = new Notification('MDG Font Manager', {\n\t\tbody: `An error occured whilst exporting the fonts.`\n\t})\n})\n\nipcRenderer.on('import-ok', (event, message) => {\n\t\n\tupdateLists()\n\t\n\tlet fontExportOk = new Notification('MDG Font Manager', {\n\t\tbody: `The fonts have been installed to: ${message}`\n\t})\n})\n\n\nipcRenderer.on('import-failed', () => {\n\t\n\tupdateLists()\n\t\n\tlet fontExportError = new Notification('MDG Font Manager', {\n\t\tbody: `An error occured whilst importing the fonts.`\n\t})\n})\n\nipcRenderer.on('update-path', () => {\n\t\n\t$('#active-list li, #disabled-list li').remove()\n\t$('#update-all').prop('disabled', true)\n\tpopulateFontLists()\n})\n\nipcRenderer.on('reload', () => {\n\t\n\tupdateLists()\n})\n\n//note(@duncanmid): tidy this up!\n\nipcRenderer.on('reorder', (event, message) => {\n\t\t\n\tif( message[1] == 2 ) {\n\t\t\n\t\tmessage[1] = store.get( `fontOrder.${message[0]}` )\n\t}\n\t\n\t\n\tif( store.get( `fontOrder.${message[0]}` ) == message[1] ) {\n\t\t\n\t\tlet prefs = store.get('appPrefs'),\n\t\t\tdivider = '';\n\t\t\n\t\t$(`#${message[0]}-list li.divider`).remove()\n\t\t\n\t\tlet list = $(`#${message[0]}-list`),\n\t\t\tlistItems = list.children('li.item')\n\t\t\n\t\tlistItems = listItems.get().reverse()\n\t\t\n\t\t$(`#${message[0]}-list`).empty()\n\t\t\n\t\tlistItems.forEach( function(item) {\n\t\t\t\n\t\t\tif( prefs.dividers ) {\n\t\t\t\n\t\t\t\tif( divider !== $(item).data('name').charAt(0) ) {\n\t\t\t\t\t\n\t\t\t\t\tdivider = $(item).data('name').charAt(0).toUpperCase()\n\t\t\t\t\t\n\t\t\t\t\t$(`#${message[0]}-list`).append(`<li class=\"divider\"><span>${divider}</span></li>`)\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t$(`#${message[0]}-list`).append(item)\n\t\t})\n\t\t\n\t\tstore.set( `fontOrder.${message[0]}`, (1 - message[1] )  )\n\t}\n})\n\n\n\n//note(@duncanmid): show / hide bezel\n\nipcRenderer.on('display-bezel', (event, message) => {\n\t\n\t$('#overlay').html(`<div class=\"bezel\"><div class=\"inner\"><img src=\"../assets/svg/loader.svg\" width=\"75\" height=\"75\"><span>installing</span><span>${message}</span></div></div>`).fadeIn('fast')\n})\n\nipcRenderer.on('remove-bezel', (event, message) => {\n\n\tif( message !== 'font-not-installed' ) {\n\t\t\n\t\t$('#active-list li, #disabled-list li').remove()\n\t\t$('#update-all').prop('disabled', true)\n\t\tpopulateFontLists()\n\t\t$('#overlay').fadeOut('fast').empty()\n\t\t\t\n\t\tlet dir = store.get('fontDirectories.activePath')\n\t\t\n\t\tlet fontInstalled = new Notification('MDG Font Manager', {\n\t\t\tbody: `The font ${message} has been installed to ${dir}`\n\t\t})\n\t\n\t} else {\n\t\t\n\t\t$('#overlay').fadeOut('fast').empty()\n\t}\n})\n\n\n\n//note(@duncanmid): drag items in to window\n\nfunction setDragArea( id ) {\n\n\tlet dragArea = document.getElementById( id )\n\t\n\tlet draggedItems = {\n\t\t'location': id,\n\t\t'list': []\n\t}\n\t\n\tdragArea.ondragover = () => {\n\t\t\n\t\t$( dragArea ).addClass('dragover')\n\t\treturn false\n\t}\n\t\n\tdragArea.ondragleave = () => {\n\t\t\n\t\t$( dragArea ).removeClass('dragover')\n\t\treturn false\n\t}\n\t\n\tdragArea.ondragend = () => {\n\t\t\n\t\t$( dragArea ).removeClass('dragover')\n\t\treturn false\n\t}\n\t\n\tdragArea.ondrop = (event) => {\n\t\t\n\t\tevent.preventDefault()\n\t\t$( dragArea ).removeClass('dragover')\n\t\t\n\t\tlet files = []\n\t\t\n\t\tfor (let item of event.dataTransfer.files) {\n\t\t\t\n\t\t\tdraggedItems.list.push( item.path )\n\t\t}\n\t\t\n\t\tipcRenderer.send('import', draggedItems )\n\t\tdraggedItems.list = []\n\t}\n}\n\nsetDragArea( 'left-panel' )\nsetDragArea( 'right-panel' )\n\n\n\n//note(@duncanmid): search field\n\n// based on https://gist.github.com/dennysfredericci/ca99b08648649b545dfd\n\n$('#search').bind('keyup', function() {\n\n\tlet searchString = $(this).val()\n\t\n\t$('ul li').each(function(index, value) {\n\t\n\tlet currentName = $(value).text()\n\tif( currentName.toUpperCase().indexOf(searchString.toUpperCase()) > -1) {\n\t\t\t\n\t\t\t$(value).show()\n\t\n\t\t} else {\n\t\t\t\n\t\t\tif(!$(value).hasClass('selected')) {\n\t\t\t\t\t\n\t\t\t\t$(value).hide()\n\t\t\t}\n\t\t}\n\t})\n})\n\n\n\n//note(@duncanmid): modal\n\nfunction openModal( url, width, height, resize ) {\n\t\n\tmodal = new remote.BrowserWindow({\n\t\t\n\t\t\tparent: remote.getCurrentWindow(),\n\t\t\tmodal: true,\n\t\t\twidth: width,\n\t\t\tminWidth: width,\n\t\t\tmaxWidth: width,\n\t\t\theight: height,\n\t\t\tminHeight: height,\n\t\t\tresizable: resize,\n\t\t\tshow: false,\n\t\t\tbackgroundColor: '#293641'\n\t\t})\n\t\t\n\tmodal.loadURL( url )\n\t\n\tmodal.once('ready-to-show', () => {\n\t\t\n\t\tmodal.show()\n\t})\n}\n"]}