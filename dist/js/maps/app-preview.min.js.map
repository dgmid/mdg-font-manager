{"version":3,"sources":["app-preview.js"],"names":["window","$","jQuery","require","fs","ipcRenderer","electron","remote","dialog","path","loadJsonFile","Store","store","listItem","type","selected","data","name","font","append","injectCSS","family","url","html","appendTo","addPreview","fontName","color","get","size","result","split","replace","injectGlyphs","join","__dirname","then","json","i","len","length","styleGlyphs","css","font-family","font-size","setPrefs","val","background-color","on","event","message","stat","err","stats","code","showErrorBox","isDirectory","count","readdir","files","file","startsWith","target","item","this","removeClass","toggleClass","fadeOut","promise","done","fadeIn","click","change","set","document","ready"],"mappings":"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","file":"../app-preview.min.js","sourcesContent":["'use strict'\n\nwindow.$ = window.jQuery = require( 'jquery' )\nconst fs = require( 'fs-extra' )\nconst {ipcRenderer} = require( 'electron' )\nconst electron = require(\"electron\")\nconst remote = electron.remote\nconst dialog = remote.dialog\nconst path = require('path')\nconst loadJsonFile = require('load-json-file')\nconst Store = require( 'electron-store' )\nconst store = new Store()\n\n\n\nipcRenderer.on('selected-font', (event, message) => {\n\t\n\tlet name = message[0],\n\t\tpath = message[1]\t\n\t\n\tinjectGlyphs()\n\t\n\tfs.stat( path, ( err,stats ) => {\n\t\t\n\t\tif( err ) {\n\n\t\t\tif( err.code ) {\n\t\t\t\t\t\t\t\t\t\n\t\t\t\tdialog.showErrorBox(\n\t\t\t\t\t`An error occured whilst previewing the font: ${name}`, err.code\n\t\t\t\t)\n\t\t\t}\n\t\t\t\n\t\t\treturn\n\t\t}\n\t\t\n\t\tif( stats.isDirectory() ) {\n\t\t\t\n\t\t\tlet count = 0;\n\t\t\t\n\t\t\tlistItem( 'folder', 'selected', 'show-all', name, fontName( name, 0 ) )\n\t\t\t\n\t\t\tfs.readdir( path, ( err, files ) => {\n\n\t\t\t\tif ( err ) throw  err\n\n\t\t\t\tfor ( let file of files ) {\n\t\t\t\t\n\t\t\t\t\tif( !file.startsWith('.') ) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tinjectCSS( fontName( file, 1 ), file, path, 0 )\n\t\t\t\t\t\tlistItem( 'file', '', fontName( file, 1 ), file, fontName( file, 0 ) )\n\t\t\t\t\t\taddPreview( file )\n\t\t\t\t\t\t\n\t\t\t\t\t\tif( count == 0 ) { styleGlyphs( fontName( file, 1 ) ) }\n\t\t\t\t\t\t\n\t\t\t\t\t\tcount++\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\n\t\t} else {\n\t\t\t\n\t\t\tinjectCSS( fontName( name, 1 ), name, path, 1 )\n\t\t\tlistItem( 'file', 'selected', fontName( name, 1 ), name, fontName( name, 0 ) )\n\t\t\taddPreview( name )\n\t\t\tstyleGlyphs( fontName( name, 1 ) )\n\t\t}\n\t})\n})\n\n\n\nfunction listItem( type, selected, data, name, font ) {\n\t\n\t\n\t\n\t$('#font-list ul').append(\n\t\t\n\t\t`<li class=\"${type} ${selected}\" data-font=\"${data}\" title=\"${name}\">\n\t\t\t<div>${font}</div>\n\t\t</li>`\n\t)\n}\n\n\nfunction injectCSS( family, name, path, type ) {\n\t\t\n\tlet url\n\t\n\t//note(@duncanmid): 0 = folder, 1 = file\n\t\n\tif( type == 0) {\n\t\t\n\t\turl = `${path}/${name}`\n\t\n\t} else {\n\t\t\n\t\turl = path\n\t}\n\t\n\tlet div = $('<div />', {\n\t\n\t\thtml: `<style>\n\t\t\t\t@font-face {\n\t\t\t\t\tfont-family: \"${family}\";\n\t\t\t\t\tsrc:url(\"file://${url}\");\n\t\t\t\t}\n\t\t\t</style>`\n\t\n\t}).appendTo(\"body\")\n}\n\n\n\nfunction addPreview( name ) {\n\t\n\tlet font \t= fontName( name, 0 ),\n\t\tfamily \t= fontName( name, 1 ),\n\t\tcolor \t= store.get('fontPreview.color'),\n\t\tsize \t= store.get('fontPreview.size')\n\t\n\t$('#preview-list').append(\n\t\n\t`<article class=\"preview-item\" data-target=\"${family}\">\n\t\t<h2>${font}</h2>\n\t\t<div class=\"preview-text\" style=\"font-family: \\'${family}\\'; color: ${color}; font-size: ${size}px;\">\n\t\t\t<p>ABCDEFGHIJKLM<br>NOPQRSTUVWXYZ<br>\n\t\t\tabcdefghijklm<br>nopqrstuvwxyz<br>\n\t\t\t1234567890</p>\n\t\t</div>\n\t</article>`\n\t)\n}\n\n\n\nfunction fontName( name, type ) {\n\t\n\t//note(@duncanmid): 0 = font name, 1 = font-family\n\t\n\tlet font = name.split('.'),\n\t\tresult\n\t\n\tif( type == 0) {\n\t\t\n\t\tresult = font[0].replace( /(-|_)/g, ' ' )\n\t\n\t} else {\n\t\t\n\t\tresult = font[0]\n\t}\n\t\n\treturn result\n}\n\n\n\nfunction injectGlyphs() {\n\t\n\t\n\t\n\tloadJsonFile( path.join(__dirname, '../json/unicode-chars.json') ).then(json => {\n    \n\t\tfor (let i = 0, len = json.length; i < len; i++) {\n\t\t\t\n\t\t\t$('#glyph-list').append(\n\t\t\t\t\n\t\t\t\t`<div class=\"glyph-item\" title=\"${json[i]['n']}\">&${json[i]['h']}</div>`\n\t\t\t);\n\t\t}\n\t})\t\n}\n\n\n\nfunction styleGlyphs( name ) {\n\t\n\tlet {size, color} = store.get('fontPreview')\n\t\n\t$('#glyph-list').css({\t'font-family': name,\n\t\t\t\t\t\t\t'color': color,\n\t\t\t\t\t\t\t'font-size': size + 'px'\n\t\t\t\t\t\t})\n}\n\n\n\n$('body').on('click', '#font-list ul li', function(event) {\n\t\n\tlet target,\n\t\titem = $(this).data('font')\n\t\n\tif( item !== 'show-all' ) { styleGlyphs( item ) }\n\t\n\titem == 'show-all' ? target = $('#preview-list article') : target = $(`#preview-list article[data-target=\"${item}\"]`)\n\t\n\t$('#font-list ul li').removeClass('selected')\n\t$(this).toggleClass('selected')\n\t\n\t$('#preview-list article').fadeOut().promise().done( function() {\n\t\t\n\t\ttarget.fadeIn('fast')\n\t})\n})\n\n\n\n$('#show-fonts').click( function() {\n\t\n\t$('#glyph-list').fadeOut().promise().done( function() {\n\t\t\n\t\t$('#preview-list').fadeIn('fast')\n\t})\n})\n\n\n\n$('#show-glyphs').click( function() {\n\t\n\t$('#preview-list').fadeOut().promise().done( function() {\n\t\t\n\t\t$('#glyph-list').fadeIn('fast')\n\t})\n})\n\n\n\n$('#font-size').change( function() {\n\t\n\tlet val = $(this).val()\n\t\n\t$('.preview-text, #glyph-list').css({'font-size': `${val}px`})\n\t$('#font-size-val').html(val)\n\tstore.set('fontPreview.size', val)\n})\n\n\n\n$('#font-color').change( function() {\n\t\n\tlet val = $(this).val()\n\t\n\t$('.preview-text, #glyph-list').css({'color': val})\n\t$('#font-color-swatch').css({'background-color': val})\n\tstore.set('fontPreview.color', val)\n})\n\n\n\nfunction setPrefs() {\n\t\n\tlet {size, color} = store.get('fontPreview')\n\t\n\t$('#font-size').val(size)\n\t$('#font-size-val').html(size)\n\t$('#font-color').val(color)\n\t$('#font-color-swatch').css({'background-color': color})\n}\n\n\n\n$(document).ready(function() {\n\t\n\tsetPrefs()\t\n})\n"]}